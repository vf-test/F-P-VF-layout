import Lottie from "lottie-web";
const fuzzysort                         = require('fuzzysort');
const slick                             = require('slick-carousel');
const Chart                             = require('chart.js');
Chart.defaults.global.defaultFontColor  = '#748B90';
Chart.defaults.global.defaultFontFamily = 'GD Sherpa';
Chart.defaults.global.defaultFontSize   = 14;
Chart.defaults.global.defaultFontStyle  = 'Normal';
Chart.defaults.global.tooltips.enabled  = false;
Chart.plugins.register({
  beforeDraw: function(chartInstance) {
    let ctx = chartInstance.chart.ctx;
    ctx.fillStyle = '#ffffff';
    let chartArea = chartInstance.chartArea;
    ctx.fillRect(chartArea.left, chartArea.top, chartArea.right - chartArea.left, chartArea.bottom - chartArea.top);
  }
});

//  View
// ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
module.exports = function () {

	const NAME = 'CITY PORTAL';

	w.log.log(NAME + ' > page was loaded.');

	const json_cta_email = {"v":"5.7.4","fr":60,"ip":0,"op":40,"w":100,"h":94,"nm":"GD_envelope-001","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"paper line","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0.167],"y":[0.167]},"t":8,"s":[0]},{"i":{"x":[0],"y":[1]},"o":{"x":[0.05],"y":[0]},"t":10,"s":[100]},{"i":{"x":[0],"y":[1]},"o":{"x":[0.05],"y":[0]},"t":15,"s":[100]},{"t":20,"s":[0]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0,"y":1},"o":{"x":0.05,"y":0},"t":10,"s":[50,48,0],"to":[0,-0.667,0],"ti":[0,0.667,0]},{"t":20,"s":[50,44,0]}],"ix":2,"l":2},"a":{"a":0,"k":[0,0,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[-40,-15],[43,-15]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[1,1,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":9,"ix":5},"lc":2,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Shape 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":40,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"paper up","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":15,"s":[0]},{"t":20,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[50,47.75,0],"ix":2,"l":2},"a":{"a":0,"k":[0,0,0],"ix":1,"l":2},"s":{"a":0,"k":[105.457,105.457,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0],[-8.75,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0],[8.75,0],[0,0],[0,0]],"v":[[43.75,-30.5],[-43.25,-30.5],[-43.25,-14],[-13.75,12.562],[0.5,5.25],[15,12.75],[43.75,-12.75]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[1,1,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":9,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0,0.258823529412,0.286274509804,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[87.454,82.448],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Shape 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":40,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"envelope closed2 Outlines","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[100]},{"t":10,"s":[0]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[50,59,0],"ix":2,"l":2},"a":{"a":0,"k":[50,50,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.823,0.199],[0,0],[0,0],[-3.389,0],[-3.294,2.803],[0,0],[0,0]],"o":[[0,0],[0,0],[3.26,2.803],[3.387,0],[0,0],[0,0],[-0.835,0.201]],"v":[[-34.779,26.018],[-11.707,5.027],[-9.757,6.609],[0.033,10.585],[9.786,6.609],[11.679,5.033],[34.945,26.143]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0]],"v":[[18.38,0.466],[42.155,-20.437],[42.155,22.7]],"c":true},"ix":2},"nm":"Path 2","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0]],"v":[[-42.16,-20.437],[-18.386,0.466],[-41.937,22.493]],"c":true},"ix":2},"nm":"Path 3","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[1.993,1.6],[0,0],[-0.518,0.013],[-0.428,-0.01],[0,0],[1.77,0]],"o":[[0,0],[0.384,-0.102],[0,0],[0,0],[-1.946,1.65],[-1.77,0]],"v":[[-5.454,1.501],[-37.079,-26.359],[-35.747,-26.529],[37.258,-26.529],[5.413,1.501],[0.033,3.885]],"c":true},"ix":2},"nm":"Path 4","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[-9.73,0],[0,0],[0,8.161],[0,0],[9.672,0],[0,0],[0,-8.161],[0,0]],"o":[[0,0],[8.124,0],[0,0],[0,-8.161],[0,0],[-8.183,0],[0,0],[0,8.161]],"v":[[-35.407,33.148],[37.008,33.148],[49.997,20.962],[49.997,-20.963],[35.402,-33.148],[-37.013,-33.148],[-50.003,-20.963],[-50.003,20.962]],"c":true},"ix":2},"nm":"Path 5","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"mm","mm":1,"nm":"Merge Paths 1","mn":"ADBE Vector Filter - Merge","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[49.997,52.216],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":9,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":40,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"envelope open2 Outlines","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":10,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[50,48,0],"ix":2,"l":2},"a":{"a":0,"k":[50,50,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[-1.84,0],[-1.946,-1.786],[0,0],[0,0]],"o":[[1.993,-1.818],[1.841,0],[0,0],[0,0],[0,0]],"v":[[-5.451,13.505],[0.035,10.933],[5.416,13.505],[34.947,40.301],[-34.947,40.301]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[0.296,-0.831],[0,0],[0,0]],"o":[[0.033,0.872],[0,0],[0,0],[0,0]],"v":[[42.157,34.285],[41.759,36.858],[17.773,15.184],[42.157,-7.145]],"c":true},"ix":2},"nm":"Path 2","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[-0.03,0.88],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[-0.272,-0.844]],"v":[[-42.157,34.285],[-42.157,-7.145],[-17.772,15.184],[-41.793,36.889]],"c":true},"ix":2},"nm":"Path 3","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[0,0],[-1.782,0],[-2.228,-1.69],[0,0],[0,0],[0,0],[3.318,0],[3.259,-2.991],[0,0],[0,0]],"o":[[2.298,-1.69],[1.782,0],[0,0],[0,0],[0,0],[-3.271,-2.991],[-3.318,0],[0,0],[0,0],[0,0]],"v":[[-5.24,-37.406],[-0.023,-39.967],[5.182,-37.438],[38.382,-13.398],[12.45,10.352],[9.789,7.931],[0.059,3.68],[-9.73,7.931],[-12.485,10.352],[-38.382,-13.398]],"c":true},"ix":2},"nm":"Path 4","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[-9.731,0],[0,0],[0,8.824],[0,0],[3.997,2.938],[0,0],[3.434,0],[3.552,-2.733],[0,0],[0,-5.833],[0,0]],"o":[[0,0],[9.672,0],[0,0],[0,-5.833],[0,0],[-3.516,-2.69],[-3.435,0],[0,0],[-4.068,2.938],[0,0],[0,8.81]],"v":[[-35.404,47.5],[35.404,47.5],[50,34.264],[50,-6.037],[44.514,-17.703],[9.707,-43.196],[-0.023,-47.5],[-9.707,-43.196],[-44.502,-17.703],[-50,-6.037],[-50,34.285]],"c":true},"ix":2},"nm":"Path 5","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"mm","mm":1,"nm":"Merge Paths 1","mn":"ADBE Vector Filter - Merge","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[50,48.797],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":9,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":40,"st":0,"bm":0}],"markers":[]};
	const json_graph_86 = {"v":"5.7.4","fr":60,"ip":0,"op":90,"w":300,"h":300,"nm":"GD_piechart-002","ddd":0,"assets":[],"fonts":{"list":[{"fName":"GDSherpa-Bold","fFamily":"GD Sherpa","fStyle":"Bold","ascent":69.04296875}]},"layers":[{"ddd":0,"ind":1,"ty":5,"nm":"86%","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":40,"s":[0]},{"t":65,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[96.122,133.733,0],"ix":2,"l":2},"a":{"a":0,"k":[0.122,-14.704,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"t":{"d":{"k":[{"s":{"s":40,"f":"GDSherpa-Bold","t":"86%","j":2,"tr":0,"lh":48,"ls":0,"fc":[1,1,1]},"t":0}]},"p":{},"m":{"g":1,"a":{"a":0,"k":[0,0],"ix":2}},"a":[]},"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"pacman 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[148.226,140.226,0],"ix":2,"l":2},"a":{"a":0,"k":[-153.774,-121.774,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[125,125],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.64313695571,0.650979973288,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":125,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[-150.768,-112.142],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[86]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[90]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"inside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":30,"s":[0]},{"t":60,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":0,"k":[60,60,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"outside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":53,"s":[0]},{"t":68,"s":[30]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.25,0.25,0.25],"y":[1,1,1]},"o":{"x":[0.33,0.33,0.33],"y":[0,0,0]},"t":53,"s":[0,0,100]},{"t":68,"s":[85,85,100]}],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0}],"markers":[],"chars":[{"ch":"8","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-13.184,0],[0,14.111],[6.982,3.809],[0,6.006],[11.377,0],[0,-11.963],[-4.541,-3.564],[0,-7.959]],"o":[[13.086,0],[0,-7.666],[4.248,-3.369],[0,-11.768],[-11.426,0],[0,5.713],[-6.348,3.76],[0,13.916]],"v":[[29.004,0.977],[54.492,-19.922],[43.848,-37.305],[50.977,-51.318],[29.004,-70.02],[6.982,-51.221],[14.111,-37.305],[3.516,-19.824]],"c":true},"ix":2},"nm":"8","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[5.811,0],[0,5.469],[-5.42,0],[0,-5.713]],"o":[[-6.104,0],[0,-5.908],[5.713,0],[0,5.664]],"v":[[29.199,-41.895],[19.189,-50.977],[29.199,-59.717],[39.209,-50.781]],"c":true},"ix":2},"nm":"8","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[7.275,0],[0,7.422],[-7.715,0],[0,-7.08]],"o":[[-7.227,0],[0,-6.982],[7.617,0],[0,7.324]],"v":[[28.906,-9.619],[15.576,-20.508],[28.906,-31.396],[42.188,-20.41]],"c":true},"ix":2},"nm":"8","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"8","np":6,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"6","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-14.014,0],[0,12.793],[14.16,0],[0,0],[0,0],[0,0],[0,0],[0,-4.736]],"o":[[14.6,0],[0,-14.111],[0,0],[0,0],[0,0],[0,0],[-4.883,7.959],[0,13.184]],"v":[[29.102,0.977],[54.297,-23.193],[29.59,-46.289],[27.686,-46.289],[42.578,-68.994],[28.418,-68.994],[10.352,-39.307],[4.004,-22.656]],"c":true},"ix":2},"nm":"6","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[7.08,0],[0,6.885],[-7.178,0],[0,-6.885]],"o":[[-7.178,0],[0,-6.885],[7.08,0],[0,6.885]],"v":[[29.199,-10.596],[16.113,-23.096],[29.199,-35.596],[42.188,-23.096]],"c":true},"ix":2},"nm":"6","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"6","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"%","size":40,"style":"Bold","w":75.2,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[12.793,0.977],[23.096,0.977],[61.719,-70.996],[51.416,-70.996]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[17.285,-40.381],[31.592,-54.688],[17.285,-68.994],[2.979,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[17.285,-48.389],[10.986,-54.688],[17.285,-60.986],[23.682,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[57.91,0],[72.217,-14.307],[57.91,-28.613],[43.604,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[57.91,-8.008],[51.611,-14.307],[57.91,-20.605],[64.307,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"%","np":8,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"}]};
	const json_graph_40 = {"v":"5.7.4","fr":60,"ip":0,"op":90,"w":300,"h":300,"nm":"GD_piechart-002","ddd":0,"assets":[],"fonts":{"list":[{"fName":"GDSherpa-Bold","fFamily":"GD Sherpa","fStyle":"Bold","ascent":69.04296875}]},"layers":[{"ddd":0,"ind":1,"ty":5,"nm":"40%","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":40,"s":[0]},{"t":65,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[96.122,133.733,0],"ix":2,"l":2},"a":{"a":0,"k":[0.122,-14.704,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"t":{"d":{"k":[{"s":{"s":40,"f":"GDSherpa-Bold","t":"40%","j":2,"tr":0,"lh":48,"ls":0,"fc":[1,1,1]},"t":0}]},"p":{},"m":{"g":1,"a":{"a":0,"k":[0,0],"ix":2}},"a":[]},"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"pacman 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[148.226,140.226,0],"ix":2,"l":2},"a":{"a":0,"k":[-153.774,-121.774,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[125,125],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.64313695571,0.650979973288,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":125,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[-150.768,-112.142],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[40]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[220]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"inside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":30,"s":[0]},{"t":60,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":0,"k":[60,60,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"outside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":53,"s":[0]},{"t":68,"s":[30]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.25,0.25,0.25],"y":[1,1,1]},"o":{"x":[0.33,0.33,0.33],"y":[0,0,0]},"t":53,"s":[0,0,100]},{"t":68,"s":[85,85,100]}],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0}],"markers":[],"chars":[{"ch":"4","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],"v":[[32.52,0],[44.482,0],[44.482,-16.211],[55.518,-16.211],[55.518,-27.49],[44.482,-27.49],[44.482,-68.994],[34.082,-68.994],[0.391,-23.389],[0.391,-16.211],[32.52,-16.211]],"c":true},"ix":2},"nm":"4","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0]],"v":[[16.504,-27.49],[32.52,-50],[32.52,-27.49]],"c":true},"ix":2},"nm":"4","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"4","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"0","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-21.387,0],[0,17.139],[18.994,0],[0,-14.697]],"o":[[18.506,0],[0,-17.188],[-20.898,0],[0,14.6]],"v":[[29.492,0.977],[56.689,-34.424],[28.809,-70.117],[1.514,-34.521]],"c":true},"ix":2},"nm":"0","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[10.498,0],[0,11.035],[-10.791,0],[0,-11.084]],"o":[[-11.182,0],[0,-11.084],[10.791,0],[0,10.84]],"v":[[29.199,-10.693],[13.721,-34.521],[28.809,-58.203],[43.896,-34.619]],"c":true},"ix":2},"nm":"0","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"0","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"%","size":40,"style":"Bold","w":75.2,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[12.793,0.977],[23.096,0.977],[61.719,-70.996],[51.416,-70.996]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[17.285,-40.381],[31.592,-54.688],[17.285,-68.994],[2.979,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[17.285,-48.389],[10.986,-54.688],[17.285,-60.986],[23.682,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[57.91,0],[72.217,-14.307],[57.91,-28.613],[43.604,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[57.91,-8.008],[51.611,-14.307],[57.91,-20.605],[64.307,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"%","np":8,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"}]};
	const json_graph_24 = {"v":"5.7.4","fr":60,"ip":0,"op":90,"w":300,"h":300,"nm":"GD_piechart-002","ddd":0,"assets":[],"fonts":{"list":[{"fName":"GDSherpa-Bold","fFamily":"GD Sherpa","fStyle":"Bold","ascent":69.04296875}]},"layers":[{"ddd":0,"ind":1,"ty":5,"nm":"24%","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":40,"s":[0]},{"t":65,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[96.122,133.733,0],"ix":2,"l":2},"a":{"a":0,"k":[0.122,-14.704,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"t":{"d":{"k":[{"s":{"s":40,"f":"GDSherpa-Bold","t":"24%","j":2,"tr":0,"lh":48,"ls":0,"fc":[1,1,1]},"t":0}]},"p":{},"m":{"g":1,"a":{"a":0,"k":[0,0],"ix":2}},"a":[]},"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"pacman 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[148.226,140.226,0],"ix":2,"l":2},"a":{"a":0,"k":[-153.774,-121.774,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[125,125],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.64313695571,0.650979973288,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":125,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[-150.768,-112.142],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[24]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[245]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"inside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":30,"s":[0]},{"t":60,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":0,"k":[60,60,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"outside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":53,"s":[0]},{"t":68,"s":[30]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.25,0.25,0.25],"y":[1,1,1]},"o":{"x":[0.33,0.33,0.33],"y":[0,0,0]},"t":53,"s":[0,0,100]},{"t":68,"s":[85,85,100]}],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0}],"markers":[],"chars":[{"ch":"2","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0],[0,20.312],[14.258,0],[0,-13.77],[0,0],[-9.131,0],[0,-5.713],[0,-25.049]],"o":[[0,0],[0,0],[0,0],[5.469,-9.863],[0,-12.988],[-15.869,0],[0,0],[0,-7.422],[6.592,0],[0,19.922],[0,0]],"v":[[3.809,0],[53.857,0],[53.857,-11.182],[19.824,-11.182],[50.342,-49.219],[29.004,-70.02],[4.248,-44.434],[16.65,-44.434],[28.076,-58.936],[37.402,-49.219],[3.809,-1.416]],"c":true},"ix":2},"nm":"2","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"2","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"4","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],"v":[[32.52,0],[44.482,0],[44.482,-16.211],[55.518,-16.211],[55.518,-27.49],[44.482,-27.49],[44.482,-68.994],[34.082,-68.994],[0.391,-23.389],[0.391,-16.211],[32.52,-16.211]],"c":true},"ix":2},"nm":"4","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0]],"v":[[16.504,-27.49],[32.52,-50],[32.52,-27.49]],"c":true},"ix":2},"nm":"4","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"4","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"%","size":40,"style":"Bold","w":75.2,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[12.793,0.977],[23.096,0.977],[61.719,-70.996],[51.416,-70.996]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[17.285,-40.381],[31.592,-54.688],[17.285,-68.994],[2.979,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[17.285,-48.389],[10.986,-54.688],[17.285,-60.986],[23.682,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[57.91,0],[72.217,-14.307],[57.91,-28.613],[43.604,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[57.91,-8.008],[51.611,-14.307],[57.91,-20.605],[64.307,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"%","np":8,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"}]};
	const json_graph_50 = {"v":"5.7.4","fr":60,"ip":0,"op":90,"w":300,"h":300,"nm":"GD_piechart-002","ddd":0,"assets":[],"fonts":{"list":[{"fName":"GDSherpa-Bold","fFamily":"GD Sherpa","fStyle":"Bold","ascent":69.04296875}]},"layers":[{"ddd":0,"ind":1,"ty":5,"nm":"50%","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":40,"s":[0]},{"t":65,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[96.122,133.733,0],"ix":2,"l":2},"a":{"a":0,"k":[0.122,-14.704,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"t":{"d":{"k":[{"s":{"s":40,"f":"GDSherpa-Bold","t":"50%","j":2,"tr":0,"lh":48,"ls":0,"fc":[1,1,1]},"t":0}]},"p":{},"m":{"g":1,"a":{"a":0,"k":[0,0],"ix":2}},"a":[]},"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"pacman 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[148.226,140.226,0],"ix":2,"l":2},"a":{"a":0,"k":[-153.774,-121.774,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[125,125],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.64313695571,0.650979973288,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":125,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[-150.768,-112.142],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[50]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.67],"y":[1]},"o":{"x":[0.75],"y":[0]},"t":0,"s":[0]},{"t":60,"s":[210]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"inside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":30,"s":[0]},{"t":60,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":0,"k":[60,60,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"outside circle","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.5],"y":[1]},"o":{"x":[0.5],"y":[0]},"t":53,"s":[0]},{"t":68,"s":[30]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[150.836,149.973,0],"ix":2,"l":2},"a":{"a":0,"k":[-1.896,8.025,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.25,0.25,0.25],"y":[1,1,1]},"o":{"x":[0.33,0.33,0.33],"y":[0,0,0]},"t":53,"s":[0,0,100]},{"t":68,"s":[85,85,100]}],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[350,350],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847058823529,0.937254901961,0.937254901961,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-1.896,8.025],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":90,"st":0,"bm":0}],"markers":[],"chars":[{"ch":"5","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-14.111,0],[0,14.258],[12.646,0],[3.711,-2.051],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[-4.932,0],[0,-7.666],[7.227,0],[1.66,8.594],[0,0]],"o":[[14.697,0],[0,-13.916],[-4.15,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[3.32,-4.15],[7.471,0],[0,8.301],[-7.324,0],[0,0],[2.734,12.695]],"v":[[28.613,0.977],[54.004,-23.828],[31.445,-47.266],[19.58,-44.141],[22.119,-57.666],[49.805,-57.666],[49.805,-69.043],[12.402,-69.043],[5.811,-33.057],[16.553,-30.371],[28.76,-36.426],[41.309,-23.584],[28.613,-10.059],[15.186,-23.193],[3.369,-19.922]],"c":true},"ix":2},"nm":"5","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"5","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"0","size":40,"style":"Bold","w":58.01,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-21.387,0],[0,17.139],[18.994,0],[0,-14.697]],"o":[[18.506,0],[0,-17.188],[-20.898,0],[0,14.6]],"v":[[29.492,0.977],[56.689,-34.424],[28.809,-70.117],[1.514,-34.521]],"c":true},"ix":2},"nm":"0","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[10.498,0],[0,11.035],[-10.791,0],[0,-11.084]],"o":[[-11.182,0],[0,-11.084],[10.791,0],[0,10.84]],"v":[[29.199,-10.693],[13.721,-34.521],[28.809,-58.203],[43.896,-34.619]],"c":true},"ix":2},"nm":"0","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"0","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"},{"ch":"%","size":40,"style":"Bold","w":75.2,"data":{"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[12.793,0.977],[23.096,0.977],[61.719,-70.996],[51.416,-70.996]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[17.285,-40.381],[31.592,-54.688],[17.285,-68.994],[2.979,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[17.285,-48.389],[10.986,-54.688],[17.285,-60.986],[23.682,-54.688]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[-7.764,0],[0,7.91],[7.91,0],[0,-7.91]],"o":[[7.91,0],[0,-7.91],[-7.764,0],[0,7.91]],"v":[[57.91,0],[72.217,-14.307],[57.91,-28.613],[43.604,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false},{"ind":4,"ty":"sh","ix":5,"ks":{"a":0,"k":{"i":[[3.613,0],[0,3.516],[-3.467,0],[0,-3.467]],"o":[[-3.467,0],[0,-3.467],[3.613,0],[0,3.516]],"v":[[57.91,-8.008],[51.611,-14.307],[57.91,-20.605],[64.307,-14.307]],"c":true},"ix":2},"nm":"%","mn":"ADBE Vector Shape - Group","hd":false}],"nm":"%","np":8,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}]},"fFamily":"GD Sherpa"}]};

	var chartInstance;
  var map;

	let focusedAutocompleteSearchResult = null;
	const cp_hero_card                  = w.el.id('city-portal-hero-card');
	const cp_hero_card_p                = w.el.id('city-portal-hero-card-p');
	const cp_hero_card_search_cont      = w.el.id('city-portal-hero-card-search-cont');
	const $autocomplete                 = $('[data-search-autocomplete]');
	const four_factors_holder           = w.el.id('four-factors-holder');
	const four_factor_slides            = document.querySelectorAll(".city-portal-four-factors__category-card-slide");
	const allCursors                    = document.querySelectorAll(".city-portal-four-factors__line-vert");
	const $map                          = $('[data-dynamic-city-map]');
	const four_factors_cat_btns         = w.el.id('category-buttons');
	const checkboxes                    = document.getElementsByClassName("global-filter__checkbox");
	const filters_select                = w.el.id('filters-select');
	const cp_cta_mail                   = new Lottie.loadAnimation({
		wrapper: document.getElementById('city-portal-mail-ani'),
		animType: 'svg',
		loop: false,
		autoplay: false,
		animationData: json_cta_email
	});
	const four_factors_ani_graphs       = document.querySelectorAll("[data-ani-four-factors-graph]");
	let cp_ani_graph_1, cp_ani_graph_2, cp_ani_graph_3, cp_ani_graph_4;
	let cp_ani_graphs                   = [cp_ani_graph_1, cp_ani_graph_2, cp_ani_graph_3, cp_ani_graph_4];
	let data_category_btn               = 4;
	const four_factors_slide_1          = w.el.id('four-factors-slide__1');
	const four_factors_slide_2          = w.el.id('four-factors-slide__2');
	const four_factors_slide_3          = w.el.id('four-factors-slide__3');
	const four_factors_slide_4          = w.el.id('four-factors-slide__4');
	let four_factors_slides             = [four_factors_slide_1, four_factors_slide_2, four_factors_slide_3, four_factors_slide_4];
  const socials                       = w.el.id('socials');

	/**
	 * init --- Initialize the view
	 */
	function init() {
		// w.log.log(NAME + ' > init');
		addHandlers();
		gsap.set(cp_hero_card, {y: 150,opacity:0});
		gsap.set(cp_hero_card_p, {opacity: 0});
		gsap.set(cp_hero_card_search_cont, {opacity: 0});
		gsap.set(four_factors_slide_1, {xPercent: -200});
		gsap.set(four_factors_slide_2, {xPercent: 200});
		gsap.set(four_factors_slide_3, {xPercent: 200});
		gsap.set(four_factors_slide_4, {xPercent: 200});
		setCityForPage(window.portal_vars.city_id);
		setupCarousel();
		setupMap();

		// TODO Add IntersectionObserver to detect proximity to slides holder as it's certainly possible that images that load
		//  into the case studies slide will change the height. A fail safe has bee put in to update the height upon category button click. We want
		//  to keep the main thread as short as possible on init. Must examine further once more content prod. has been added.

		setTimeout(() => {
			// This doesn't need to fire on init, but for prototype, it's ok. Again, use IntersectionObserver to trigger
			w.evt.fire(w.el.id('category-button__1'), 'input', onFilter, true);
		}, 1000);

		four_factors_ani_graphs.forEach((element, idx) => {
			// const one_based = idx + 1;
			const data_att = element.getAttribute('data-ani-four-factors-graph');
			// console.log(1, data_att);
			switch (data_att) {
				case '86':
					cp_ani_graphs[idx] = new Lottie.loadAnimation({
						wrapper: element,
						animType: 'svg',
						loop: false,
						autoplay: false,
						animationData: json_graph_86
					});
					break;
				case '40':
					cp_ani_graphs[idx] = new Lottie.loadAnimation({
						wrapper: element,
						animType: 'svg',
						loop: false,
						autoplay: false,
						animationData: json_graph_40
					});
					break;
				case '24':
					cp_ani_graphs[idx] = new Lottie.loadAnimation({
						wrapper: element,
						animType: 'svg',
						loop: false,
						autoplay: false,
						animationData: json_graph_24
					});
					break;
				case '50':
					cp_ani_graphs[idx] = new Lottie.loadAnimation({
						wrapper: element,
						animType: 'svg',
						loop: false,
						autoplay: false,
						animationData: json_graph_50
					});
					break;
			}
		});

	}

	/**
	 * addHandlers --- Add event handlers for view
	 */
	function addHandlers() {
		// w.log.log(NAME + ' > addHandlers');
		w.evt.addMultiple(w.el.id('hero-search'), ['input', 'focus', 'blur', 'keydown'], onSearch);
		w.evt.add(window, 'resize', onWindowResize);
		w.evt.add(four_factors_cat_btns, 'input', onFilter, true);
		w.evt.addMultiple(w.el.id('connect'), ['mouseover','mouseout'], onContact, true);
		w.evt.add(socials, 'click', onSocial);
	}

	function highlightAutocompleteResult(index) {

	    // Do nothing if autocomplete isn't active
    	if(!$autocomplete
			.is('[data-search-autocomplete-active]')) {
    		return;
    	}

    	// Clear all focus
		$autocomplete
			.find('li')
			.find('a')
			.removeAttr('data-search-autocomplete-select-is-focused');

		$autocomplete
			.find('li')
			.eq(index)
			.find('a')
			.attr('data-search-autocomplete-select-is-focused',true);
	}

	function highlightNextAutocompleteResult() {
		focusedAutocompleteSearchResult = (focusedAutocompleteSearchResult == null) ? 0 : focusedAutocompleteSearchResult + 1;
		if(focusedAutocompleteSearchResult > $autocomplete
			.find('li')
			.find('a').length - 1) {
			focusedAutocompleteSearchResult = 0;
		}

		highlightAutocompleteResult(focusedAutocompleteSearchResult);
	}

	function highlightPrevAutocompleteResult() {

		focusedAutocompleteSearchResult = (focusedAutocompleteSearchResult == null) ? 0 : focusedAutocompleteSearchResult - 1;
		if(focusedAutocompleteSearchResult < 0) {
			focusedAutocompleteSearchResult = $autocomplete
								    			.find('li')
								    			.find('a')
								    			.length - 1;
		}

		highlightAutocompleteResult(focusedAutocompleteSearchResult);
	}

	/**
	 * setCityForPage --- Set the city for the page and adjust all data accordingly
	 */
	function setCityForPage(cityId, scrollToSummary) {

		let matchedCities = window.portal_vars.vf_get_all_cities_for_city_portal.cities.filter(obj => {
			return parseInt(obj.city_id) === parseInt(cityId);
		});

		if (matchedCities.length > 0) {
			let city              = matchedCities[0];
			let data_search_input = $('[data-search-input]');
			data_search_input.val(city.city_name);
			data_search_input.attr('data-has-matched-city', true);
			$autocomplete.removeAttr('data-search-autocomplete-active');
			$('[data-search-no-results]').removeAttr('data-search-no-results-active');

			// Append the city id to the URL:
			var refresh = window.location.protocol + "//" + window.location.host + window.location.pathname + '?city=' + city.city_id;
			window.history.pushState({path: refresh}, '', refresh);

			$('[data-dynamic-city-size]').text(city.city_size);
			$('[data-dynamic-city-name]').text(city.city_name);
			$('[data-default-data-summary]').hide();
			const data_dynamic_csv_download = $('[data-dynamic-csv-download]');
			let newHref                     = data_dynamic_csv_download.attr('href').replace(/city=[0-9]+/g, 'city=' + city.city_id);
			data_dynamic_csv_download.attr('href', newHref);

			// Replace table vals
			let tableNamespaces = {
				'q1_21vd': {type: 'round_to_tenth'},
				'change_vd': {type: 'percent'},
				'bb19': {type: 'percent'},
				'medinc19': {type: 'money'},
				'housing19': {type: 'money'},
				'college19': {type: 'percent'},
				'poverty19': {type: 'percent'},
				'unemp_dec20': {type: 'percent'},
				'pop19': {type: 'round'},
				'pop_3yr': {type: 'percent'},
			};

			switch (city.city_size) {
				case 'Large City':
					var keyNameSize = 'lrg';
					break;
				case 'Midsize City':
					var keyNameSize = 'med';
					break;
				case 'Small City':
				default:
					var keyNameSize = 'sm';
					break;
			}

			for (const key in tableNamespaces) {
				if (city[key]) {

					switch (tableNamespaces[key].type) {
						case 'money':
							var cityVal  = '$' + (Math.round(city[key]).toLocaleString('en'));
							var metroVal = '$' + (Math.round(city['avg_' + key + '_' + keyNameSize]).toLocaleString('en'));
							break;
						case 'percent':
							var cityVal  = Math.round(city[key]).toLocaleString('en') + '%';
							var metroVal = Math.round(city['avg_' + key + '_' + keyNameSize]).toLocaleString('en') + '%';
							break;
						case 'round_to_tenth':
							var cityVal  = (Math.round(city[key] * 100) / 100).toFixed(1).toLocaleString('en');
							var metroVal = (Math.round(city['avg_' + key + '_' + keyNameSize] * 100) / 100).toFixed(1).toLocaleString('en');
							break;
						case 'round':
						default:
							var cityVal  = Math.round(city[key]).toLocaleString('en');
							var metroVal = Math.round(city['avg_' + key + '_' + keyNameSize]).toLocaleString('en');
							break;
					}
					// console.log(cityVal);
					$('[data-dynamic-' + key + '-city').text(cityVal);
					$('[data-dynamic-' + key + '-metro').text(metroVal);
					var num = Math.round(city[key + '_peercomparison_' + keyNameSize]);
					$('[data-dynamic-' + key + '-peer').text((num >= 0 ? '+' : '') + num.toLocaleString('en') + '%');
					var num = Math.round(city[key + '_nationalcomparison']);
					$('[data-dynamic-' + key + '-national').text((num >= 0 ? '+' : '') + num.toLocaleString('en') + '%');
				}
			}

			// Switch out the image
			$map.attr('src', $map.data('image-directory') + 'graph_' + city['city_id'] + '.svg');
			$map.attr('alt', city['city_name']);

			// Switch out the map legend
			$('[data-map-legend-size]').removeClass('city-portal-microbusiness-stats__map-legend--active');
			$('[data-map-legend-size="' + city['legendflag'] + '"]').addClass('city-portal-microbusiness-stats__map-legend--active');

			// If mobile, adjust the font sizes, etc
			if ($(window).outerWidth() < 768) {
				Chart.defaults.global.defaultFontSize  = 9;
				Chart.defaults.global.defaultFontStyle = 'normal';

				var aspectRatio = 1.2;
				var labels      = [
					["Micro-", "businesses", "< 10 employees"],
					["Small", "Businesses", "10 - 249 employees"],
					["Medium & Large", "Enterprises", "250+ employees"],
				];
			} else {
				var aspectRatio = 1.7;
				var labels      = [
					["Microbusinesses", "< 10 employees"],
					["Small Businesses", "10 - 249 employees"],
					["Medium & Large Enterprises", "250+ employees"],
				];
			}

			// Determine the highest number
			let max = Math.max(
				city.sum_micro,
				city.sum_smb,
				city.sum_medlrg,
				window.portal_vars.total_national_microbusinesses,
				window.portal_vars.total_national_small_businesses,
				window.portal_vars.total_national_medium_and_large_businesses
			);

			// Configure the yAxes
			let yAxis = {
				type: 'linear',
				position: 'left',
				borderWidth: 0,
				gridLines: {
					drawBorder: false,
					color: '#767676',
					lineWidth: 1,
					tickMarkLength: 0,
					borderDash: [8, 4],
				},
				ticks: {
					padding: 12,
					suggestedMax: max,
					stepSize: (max * .25),
					callback: function (label, index, labels) {
						// return ' ';
						if (index == 1 || index == 2 || index == 3) {
							return '';
						} else if ($(window).outerWidth() < 768) {
							return label == '0' ? '0' : (label / 1000).toFixed(1) + 'k';
						} else {
							return label == '0' ? '0' : (label / 1000).toFixed(1) + 'k';
							// return (label * 1).toLocaleString('en-US');
						}
					}
				},
				scaleLabel: {
					display: true,
					labelString: 'Presence by Business Type',
				},
				color: 'red',
			};

			let yAxes = [yAxis];

			// Set up the data
			let data = {
				labels: labels,
				datasets: [
					{
						backgroundColor: '#1BDBDB',
						barPercentage: 0.4,
						barThickness: 24,
						borderRadius: {
							topLeft: 2,
							topRight: 2,
						},
						label: false,
						grouped: true,
						data: [
							city.sum_micro,
							city.sum_smb,
							city.sum_medlrg,
						]
					},
					{
						backgroundColor: '#4095E8',
						barPercentage: 0.4,
						barThickness: 24,
						borderRadius: {
							topLeft: 2,
							topRight: 2,
						},
						label: false,
						grouped: true,
						data: [
							window.portal_vars.total_national_microbusinesses,
							window.portal_vars.total_national_small_businesses,
							window.portal_vars.total_national_medium_and_large_businesses,
						]
					}
				]
			};

			// Set up the chart
			if (chartInstance) {

				chartInstance.data                 = data;
				chartInstance.options.scales.yAxes = yAxes;
				chartInstance.update();

			} else {

				var ctx       = $('#compare-chart');
				chartInstance = new Chart(ctx, {
					type: 'bar',
					data: data,
					options: {
						aspectRatio: aspectRatio,
						legend: {
							display: false
						},
						scales: {
							yAxes: yAxes,
							xAxes: [{
								gridLines: {
									display: false,
									zeroLineWidth: 0,
									zeroLineColor: '#000000',
								},
								ticks: {
									padding: 12,
									maxRotation: 0,
								},
							}]
						}
					}
				});
			}


			if (scrollToSummary) {
				$('html,body').animate({
					scrollTop: $("#data-summary").offset().top - 100
				});
			}

			/**
			 * Track search query
			 */
			if (window.portal_vars?.eid_page_slug) {
				w.log.log(`${NAME} > setCityForPage > Track > Search query: ${city.city_name} | Page EID: ${window.portal_vars.eid_page_slug}`);
				_expDataLayer.push({
					'schema': 'add_event', 'version': 'v2', 'data': {
						'eid': `comms.microsites.venture-forward/${window.portal_vars.eid_page_slug}.hero.search-selection.selected`,
						'type': 'click',
						'custom_properties': {
							'search_value': city.city_name
						}
					}
				});
			}
		}

	}

	function setupCarousel() {
		$('[data-microbusiness-carousel]').slick({
			arrows: false,
			appendDots: $('[data-microbusiness-carousel-dots]'),
			customPaging: function (slick, index) {
				return '<button id="dot_' + index + '_tab" class="global-horizontal-carousel__pagination-dot" role="tab" aria-label="Navigate to slide ' + index + '" aria-controls="global-horizontal-carousel_' + index + '_slide" aria-selected="false" tabindex="' + index + '"></button>';
			},
			autoplay: true,
			dots: true,
			slidesToShow: 1,
			centerMode: true,
			centerPadding: '0px',
		});
	}

	function setupMap() {
		// Start loading the map
		map = new mapboxgl.Map({
			container:"map",
			logoPosition:"bottom-right",
			style: 'mapbox://styles/kenmanz0/ckp5sdpav0osa17mwa304zgb3?optimize=true',
			interactive: false,
			minZoom:3,
			maxZoom:15,
			zoom: $(window).outerWidth() < 768 ? 8 : 12,
			center:[-74.0060,40.7128],
			accessToken:"pk.eyJ1Ijoia2VubWFuejAiLCJhIjoiY2swaWJmdm5nMGJpcjNubGU5NGlmbmFzeCJ9.ejCc3y6Y-1Kl9e69OOWq0g"
		});
		map.on('load', onMapLoad);
	}

	/**
	 * Upon Mapbox map load, do something
	 */
	function onMapLoad(){
		gsap.to(cp_hero_card, {
			opacity: 1,
			y: 0,
			duration: .4
		});
		gsap.to(cp_hero_card_p, {
			opacity: 1,
			duration: .4,
			delay:.41
		});
		gsap.to(cp_hero_card_search_cont, {
			opacity: 1,
			duration: .4,
			delay:.66
		});
	}

	/**
	 * suggestCitiesInSearch --- Search all city names and find the most relevant
	 */
	function suggestCitiesInSearch(searchStr) {
		let results = fuzzysort.go(searchStr, window.portal_vars.vf_get_all_cities_for_city_portal.cities, {
			threshold: -50, // Don't return matches worse than this (higher is faster)
			limit: 5, // Don't return more results than this (lower is faster)
			allowTypo: false, // Allwos a snigle transpoes (false is faster)
			key: 'city_name'
		});

		if(results.total > 0) {

			$('[data-search-no-results]').removeAttr('data-search-no-results-active');

			let html = [];
			results.forEach((v,i) => {
				html.push('<li><a data-search-autocomplete-select="' + v.obj.city_id + '">' + v.obj.city_name + '</a></li>');
			});
			$autocomplete
				.html(html.join(''))
				.attr('data-search-autocomplete-active',true);

			$('[data-search-autocomplete-select]').on('click', (e) => {
				e.preventDefault();
				setCityForPage($(e.target).data('search-autocomplete-select'), true);
				$autocomplete.removeAttr('data-search-autocomplete-active');
			});

		}else{
			$('[data-search-no-result-preview]').text(searchStr);
			$('[data-search-no-results]').attr('data-search-no-results-active', true);
			$autocomplete.removeAttr('data-search-autocomplete-active');
		}
	}

	/**
	 * onSearch --- When the user interacts with various hero elements.
	 * Event delegation is used.
	 * @param evt
	 */
	function onSearch(evt){
		const target = evt.target;
		const data_search_input = $('[data-search-input]');
		if (target && target.nodeName === "INPUT") {
			if (target.name !== "hero-search") return;
			switch (evt.type) {
				case 'input':
					// w.log.log(NAME + ` > onSearch > Search field > Input: ${evt.target.value}`);
					suggestCitiesInSearch(evt.target.value);
					break;
				case 'focus':
					// w.log.log(NAME + ` > onSearch > Search field > Focus: ${evt.target.value}`);
					$(evt.target).val('');
					data_search_input.removeAttr('data-has-matched-city');

					cp_hero_card.classList.add('city-portal-hero__card--interact');
					break;
				case 'keydown':
					// w.log.log(NAME + ` > onSearch > Search field > Key down: ${evt.target.value}, key code = ${evt.keyCode}`);
					// up arrow
				    if (evt.keyCode === 38) {
				    	// console.log('Up arrow...');
				    	highlightPrevAutocompleteResult();

				    // down arrow
				    } else if (evt.keyCode === 40) {
				    	// console.log('Down arrow...');
				    	highlightNextAutocompleteResult();

					// return / enter
				    } else if( evt.keyCode === 13 ) {

				    	$autocomplete
							.find('li')
							.eq(focusedAutocompleteSearchResult)
							.find('a')
							.click();

				    }

					break;
				case 'blur':
					// w.log.log(NAME + ` > onSearch > Search field > Blur: ${evt.target.value}`);
					focusedAutocompleteSearchResult = null;
					if(!data_search_input.attr('data-has-matched-city')) {
						$(evt.target).val('');
					}
					$autocomplete.removeAttr('data-search-autocomplete-active');
					$('[data-search-no-results]').removeAttr('data-search-no-results-active');
					cp_hero_card.classList.remove('city-portal-hero__card--interact');
					break;
			}
		}
	}

	/**
	 * onWindowResize --- Monitor Body width changes
	 * @param evt
	 */
	function onWindowResize(evt) {
		updateFourFactorHolderHeight();
	}

	/**
	 * updateFourFactorHolderHeight --- Update the parent element's width according to the tallest children’s height
	 */
	function updateFourFactorHolderHeight() {
		const winWidth                = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
		let four_factor_slides_height = 0;
		// let currentSlideHeight;

		four_factor_slides.forEach((element) => {
			// currentSlideHeight = element.offsetHeight;
			//
			// if (currentSlideHeight > four_factor_slides_height) {
			// 	four_factor_slides_height = currentSlideHeight;
			// }

			if (winWidth <= 959) {
				allCursors.forEach((element) => {
					element.setAttribute('y2', '19');
				})
			} else {
				allCursors.forEach((element) => {
					element.setAttribute('y2', '42.5');
				})
			}
		});

		let slideNo = data_category_btn - 1;
		if (four_factor_slides[slideNo]) {
			four_factor_slides_height = four_factor_slides[slideNo].offsetHeight;
		}
		four_factors_holder.style.height = four_factor_slides_height + 'px';
	}

	/**
	 * resetAllFourFactorsGraphAnimations --- Reset the cursors on the four factors slides
	 */
	function resetAllFourFactorsGraphAnimations() {
		four_factors_ani_graphs.forEach((element, idx) => {
			if (cp_ani_graphs[idx]) cp_ani_graphs[idx].goToAndStop(0, true);
		});
	}


	let analyticsInteraction = false;
	/**
	 * onFilter --- When the user selects a filter, this is triggered
	 * @param evt
	 */
	function onFilter(evt){
		const target = evt.target;
		let type;
		let label;
		if (target && target.nodeName === "INPUT") {
			type = evt.target.getAttribute('data-type');
			label = evt.target.getAttribute('aria-label').replace(/\s+/g, '-').toLowerCase();
			resetAllFourFactorsGraphAnimations();
			resetCheckboxsAndSelect(type);
			onCategory(type);
			updateFourFactorHolderHeight();

			/**
			 * Track search query
			 */
			if (!analyticsInteraction) {
				analyticsInteraction = true;
				return;
			}
			w.log.log(`${NAME} > onFilter`);
			if (window.portal_vars?.eid_page_slug) {
				w.log.log(`${NAME} > onFilter > Track > Category Label: ${label} | Page EID: ${window.portal_vars.eid_page_slug}`);
				_expDataLayer.push({
					'schema': 'add_event', 'version': 'v2', 'data': {
						'eid': `comms.microsites.venture-forward/${window.portal_vars.eid_page_slug}.four-factors.${label}.click`,
						'type': 'click'
					}
				});
			}

		} else if (target && target.nodeName === "SELECT") {
			// console.log(2, target.nodeName);
			type = filters_select.options[filters_select.options.selectedIndex].value;
			label = filters_select.options[filters_select.options.selectedIndex].text.replace(/\s+/g, '-').toLowerCase();
			resetAllFourFactorsGraphAnimations();
			resetCheckboxsAndSelect(type);
			onCategory(type);
			updateFourFactorHolderHeight();

			/**
			 * Track search query
			 */
			if (!analyticsInteraction) {
				analyticsInteraction = true;
				return;
			}
			if (window.portal_vars?.eid_page_slug) {
				w.log.log(`${NAME} > onFilter > Track > Category Label: ${label} | Page EID: ${window.portal_vars.eid_page_slug}`);
				_expDataLayer.push({
					'schema': 'add_event', 'version': 'v2', 'data': {
						'eid': `comms.microsites.venture-forward/${window.portal_vars.eid_page_slug}.four-factors.${label}.click`,
						'type': 'click'
					}
				});
			}
		}
	}

	/**
	 * resetCheckboxsAndSelect --- Sync all filters/four category buttons across mobile - desktop
	 * @param onlyShowThisType
	 */
	function resetCheckboxsAndSelect(onlyShowThisType){
		//	Uncheck all others
		for(let i = 0; i < checkboxes.length; i++) {
			// console.log(i, checkboxes[i]);
			let ckbx = checkboxes[i];
			if (ckbx.getAttribute('data-type') !== onlyShowThisType) ckbx.checked = false;
			else ckbx.checked = true;
		}

		for (let j = 0; j < filters_select.options.length; j++) {
			if(filters_select.options[j].value === onlyShowThisType) filters_select.selectedIndex = j;
		}
	}

	/**
	 * onCategory --- Move slides according to category button selection
	 * @param onlyShowThisType
	 */
	function onCategory(onlyShowThisType) {

		let category_btn  = onlyShowThisType;
		let selectedSlide = w.el.id(`four-factors-slide__${category_btn}`);

		if (category_btn === data_category_btn) {
			return;
		} else if (category_btn > data_category_btn) {
			// w.log.log(`${NAME} > onCategory > [CURRENT] [to] left | [SELECTED] [fromTo] right to left`);
			gsap.to(`#four-factors-slide__${data_category_btn}`, {
				xPercent: -200,
				opacity: .2,
				duration: .4,
				onStart: onCategorySlideStart,
				onStartParams: [selectedSlide]
			});
			gsap.fromTo(`#four-factors-slide__${category_btn}`, {
				xPercent: 200,
				opacity: .2
			}, {xPercent: 0, opacity: 1, duration: .5, ease: "timingFuncEaseOutBack3"});
			gsap.fromTo(selectedSlide.getElementsByTagName('section')[0], {xPercent: 120}, {
				xPercent: 0,
				duration: .4,
				delay: .2,
				onComplete: onCategorySlideSelectedComplete,
				onCompleteParams: [0, selectedSlide, category_btn],
				ease: "timingFuncEaseOutBack2"
			});
			gsap.fromTo(selectedSlide.getElementsByTagName('section')[1], {xPercent: 120}, {
				xPercent: 0,
				duration: .5,
				onComplete: onCategorySlideSelectedComplete,
				onCompleteParams: [1],
				ease: "timingFuncEaseOutBack3"
			});
		} else {
			// w.log.log(`${NAME} > onCategory > [CURRENT] [to] right | [SELECTED] [fromTo] left to right`);
			gsap.to(`#four-factors-slide__${data_category_btn}`, {
				xPercent: 200,
				opacity: .2,
				duration: .4,
				onStart: onCategorySlideStart,
				onStartParams: [selectedSlide]
			});
			gsap.fromTo(`#four-factors-slide__${category_btn}`, {
				xPercent: -200,
				opacity: .2
			}, {xPercent: 0, opacity: 1, duration: .5, ease: "timingFuncEaseOutBack3"});
			gsap.fromTo(selectedSlide.getElementsByTagName('section')[0], {xPercent: -120}, {
				xPercent: 0,
				duration: .4,
				delay: .2,
				onComplete: onCategorySlideSelectedComplete,
				onCompleteParams: [0, selectedSlide, category_btn],
				ease: "timingFuncEaseOutBack2"
			});
			gsap.fromTo(selectedSlide.getElementsByTagName('section')[1], {xPercent: -120}, {
				xPercent: 0,
				duration: .5,
				onComplete: onCategorySlideSelectedComplete,
				onCompleteParams: [1],
				ease: "timingFuncEaseOutBack3"
			});
		}
		data_category_btn = category_btn;
	}

	/**
	 * onCategorySlideStart --- When the old slide starts to animate off the page, do these actions.
	 * @param selectedSlide
	 */
	function onCategorySlideStart(selectedSlide) {
		// w.log.log(`${NAME} > onCategorySlideStart > Reset all animations for selected slide No.: ${selectedSlide.id[selectedSlide.id.length - 1]}`);
		// Reset all shades in selectedSlide
		// Using Array.from to 'convert' from a array-like nodes to an actual array, and then using .map to loop through the resulting array
		Array.from(selectedSlide.children).map((card) => {
				// console.log(card);
				card.getElementsByClassName('city-portal-four-factors__h4-cont-shade')[0].classList.remove('city-portal-four-factors__h4-cont-shade--trans-in');
				card.getElementsByTagName('line')[0].classList.remove('city-portal-four-factors__line-vert--trans-in');
			}
		);
	}

	/**
	 * onCategorySlideSelectedComplete --- Play cursor and canned animations by target upon category card animation conclusion
	 * @param cardNo The card number (starting from top 0, then 1)
	 * @param selectedSlide Optional, if cardNo === 0, plays the commence cursor animations for all cards
	 * @param selectedSlideNo Optional, id number associated with the selected slide (1 based)
	 */
	function onCategorySlideSelectedComplete(cardNo, selectedSlide, selectedSlideNo) {
		// w.log.log(`${NAME} > onCategorySlideSelectedComplete > Play animation: cardNo = ${cardNo}, selectedSlide = ${selectedSlide}, selectedSlideNo = ${selectedSlideNo}`);

		if (cardNo === 0) {
			//	This would set off the cursor animation for all cards in the slide
			let delay = 0;
			Array.from(selectedSlide.children).map((card) => {
					setTimeout(() => {
						card.getElementsByClassName('city-portal-four-factors__h4-cont-shade')[0].classList.add("city-portal-four-factors__h4-cont-shade--trans-in");
						card.getElementsByTagName('line')[0].classList.add('city-portal-four-factors__line-vert--trans-in');
					}, delay);
					delay += 160;
				}
			);
			let slideNo = --selectedSlideNo;
			if (cp_ani_graphs[slideNo]) cp_ani_graphs[slideNo].play();
		}
		//	This is where you‘d target a specific card’s unique animation (e.g., graph) based on the cardNo passed
	}

	/**
	 * onContact --- When a user opts to contact the Venture Forward team
	 * @param evt
	 */
	function onContact(evt) {
		let target = evt.target;

		if (target && target.nodeName === "A") {
			let classes = target.className.split(" ");
			if (classes) {
				for (let x = 0; x < classes.length; x++) {
					switch (classes[x]) {
						case "global-cta--dark-3":
							switch (evt.type) {
								case 'mouseover':
									// first frame: cp_cta_mail.goToAndStop(0, true);
									// last frame: cp_cta_mail.goToAndStop(cp_cta_mail.totalFrames-1,true);
									cp_cta_mail.setDirection(1);
									cp_cta_mail.play();
									break;
								case 'mouseout':
									cp_cta_mail.setDirection(-1);
									cp_cta_mail.play();
									break;
							}
							break;
					}
				}
			}
		}
	}


	function onSocial(evt) {
		// console.log(evt);
		let target = evt.target;

		if (target && target.nodeName === "A" || target && target.nodeName === "BUTTON") {

			let classes = target.className.split(" ");
			if (classes) {
				// Search for class and react on match
				for (let x = 0; x < classes.length; x++) {
					switch (classes[x]) {
						case "story-article__social-btns__button":
							const shareType      = target.getAttribute('data-share-button');
							const windowFeatures = "width=600,height=300,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes";
							let url              = window.location.href;

							if (shareType === 'facebook') {
								FB.ui({
									method: 'share',
									href: url,
								}, (response) => console.info("Facebook " + response));
							} else if (shareType === 'twitter') {
								window.open('https://twitter.com/intent/tweet?url=' + url, 'twitter_wdw', windowFeatures);

							} else if (shareType === 'linkedin') {
								window.open('https://www.linkedin.com/sharing/share-offsite/?url=' + url, 'linkedin_wdw', windowFeatures);
							}
							break;
					}
				}
			}
		}
	}
	init();
}
